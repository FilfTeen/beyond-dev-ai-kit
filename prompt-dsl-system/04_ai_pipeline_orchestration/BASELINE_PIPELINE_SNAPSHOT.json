{
  "generated_at": "2026-02-09T10:21:59Z",
  "pipelines": [
    {
      "pipeline": "prompt-dsl-system/04_ai_pipeline_orchestration/pipeline_bpmn_state_audit_testgen.md",
      "skills_referenced": [
        "skill_process_parse_bpmn_to_nodes",
        "skill_process_state_mapping_audit",
        "skill_process_generate_test_cases",
        "skill_docs_generate_api_contract",
        "skill_docs_generate_db_dictionary"
      ],
      "content_backup": "# Pipeline: BPMN 流程审计与测试用例生成\n\n## 适用场景\n- 基于 BPMN 文件进行流程节点解析、状态一致性审计与测试用例产出。\n\n## 输入\n- `module_path`：流程所属模块路径。\n- `objective`：必须包含以下信息：\n  - BPMN 文件路径\n  - 流程变量名\n  - 业务状态字段来源（代码/表字段/接口字段）\n- `context_id`：可选；跨 step 上下文标识（未提供可由执行方生成）。\n- `trace_id`：推荐；每次 pipeline run 唯一追踪标识。\n- `input_artifact_refs`：可选；旧模式不提供也可执行，新模式建议按 A 编号交接。\n\n## 执行步骤（Skills 顺序固定）\n\n### Step 1 - BPMN 节点解析\n- Skill：`skill_process_parse_bpmn_to_nodes`\n- 目的：抽取任务、网关、事件并形成节点清单。\n- 交接：产出节点表 `A1`，供状态审计引用。\n- 对 Codex 的调用模板：\n```yaml\nskill: skill_process_parse_bpmn_to_nodes\nparameters:\n  module_path: \"{{module_path}}\"\n  objective: \"{{objective}}；请解析 BPMN 并输出标准化节点表。\"\n  context_id: \"{{context_id}}\"\n  trace_id: \"{{trace_id}}\"\n  input_artifact_refs: []\n```\n\n### Step 2 - 状态映射审计\n- Skill：`skill_process_state_mapping_audit`\n- 目的：比对设计态与实现态，识别缺失、冲突和不可达状态。\n- 交接：优先引用 `A1`，产出状态映射表与异常清单 `A2`。\n- 对 Codex 的调用模板：\n```yaml\nskill: skill_process_state_mapping_audit\nparameters:\n  module_path: \"{{module_path}}\"\n  objective: \"{{objective}}；请输出状态映射表及异常状态清单。\"\n  context_id: \"{{context_id}}\"\n  trace_id: \"{{trace_id}}\"\n  input_artifact_refs: [\"A1\"]\n```\n\n### Step 3 - 测试用例生成\n- Skill：`skill_process_generate_test_cases`\n- 目的：覆盖主路径、异常路径、边界状态与回退路径。\n- 交接：优先引用 `A2`，产出测试用例清单 `A3`。\n- 对 Codex 的调用模板：\n```yaml\nskill: skill_process_generate_test_cases\nparameters:\n  module_path: \"{{module_path}}\"\n  objective: \"{{objective}}；基于节点与状态结果生成流程测试用例清单。\"\n  context_id: \"{{context_id}}\"\n  trace_id: \"{{trace_id}}\"\n  input_artifact_refs: [\"A2\"]\n```\n\n### Step 4 - 接口契约文档（可选）\n- Skill：`skill_docs_generate_api_contract`\n- 触发条件：流程涉及外部/内部接口调用。\n- 交接：优先引用 `A2` 与 `A3`，产出接口契约文档 `A4`。\n- 对 Codex 的调用模板：\n```yaml\nskill: skill_docs_generate_api_contract\nparameters:\n  module_path: \"{{module_path}}\"\n  objective: \"{{objective}}；如涉及接口，请补充 API 合同文档。\"\n  context_id: \"{{context_id}}\"\n  trace_id: \"{{trace_id}}\"\n  input_artifact_refs: [\"A2\", \"A3\"]\n```\n\n### Step 5 - 数据字典文档（可选）\n- Skill：`skill_docs_generate_db_dictionary`\n- 触发条件：流程涉及状态表、业务表字段或持久化变量。\n- 交接：优先引用 `A2` 与 `A3`（必要时加 `A4`），产出数据字典 `A5`。\n- 对 Codex 的调用模板：\n```yaml\nskill: skill_docs_generate_db_dictionary\nparameters:\n  module_path: \"{{module_path}}\"\n  objective: \"{{objective}}；如涉及表字段，请补充数据库字典。\"\n  context_id: \"{{context_id}}\"\n  trace_id: \"{{trace_id}}\"\n  input_artifact_refs: [\"A2\", \"A3\"]\n```\n\n## Pipeline 输出\n- 节点表（节点类型、流向、触发条件，建议编号如 `A1_*`）。\n- 状态映射表（设计状态、实现状态、映射关系、异常标记，建议编号如 `A2_*`）。\n- 测试用例清单（前置条件、步骤、预期结果、覆盖路径，建议编号如 `A3_*`）。\n- 风险点（状态漂移、并发竞态、字段口径不一致、接口契约缺失）。\n"
    },
    {
      "pipeline": "prompt-dsl-system/04_ai_pipeline_orchestration/pipeline_db_delivery_batch_and_runbook.md",
      "skills_referenced": [
        "skill_release_db_batch_packaging",
        "skill_governance_db_merged_integrity_gate",
        "skill_release_db_execution_runbook"
      ],
      "content_backup": "# Pipeline: DB Delivery Batch Packaging + Integrity Gate + Execution Runbook\n\n## 适用范围\n- 公司通用数据库交付场景（不绑定项目路径/模块）。\n- 重点数据库：Oracle + DM8；也可扩展到 MySQL 等。\n- 目标：产出可直接执行的批次包、发布前闸门规则、执行窗口 Runbook。\n\n## 输入\n- `module_path`：交付工作目录或模块边界。\n- `objective`：必须说明输入 SQL 集合、约束、验收标准与禁止项。\n- `target_db`：`oracle|dm8`（可扩展）。\n- `execution_tool`：`navicat|disql|dbeaver|generic`（可省略；runner 可从 `company_profile.yaml` 注入默认值）。\n- `schema_strategy`：`auto|login-default|embed-header|run-entry`（可省略；runner 可从 `company_profile.yaml` 注入默认值）。\n- `require_precheck_gate`：可省略；runner 可从 `company_profile.yaml` 注入默认值。\n- `context_id`：可选；跨 step 上下文标识。\n- `trace_id`：推荐；每次 pipeline run 唯一追踪标识。\n- `input_artifact_refs`：可选；允许空数组。\n\n## 执行步骤（顺序固定）\n\n### Step 1 - 批次包整理\n- Skill：`skill_release_db_batch_packaging`\n- 目的：将多个 SQL 输入整理为 Batch0~BatchN 交付包与 manifest。\n- 预期产物：\n  - `A1`：batches 目录结构建议\n  - `A2`：Batch_manifest.md（顺序、幂等性、不可逆批次、回滚点）\n  - `A3`：run_all.sql（可选一键执行入口）\n- 对 Codex 的调用模板：\n```yaml\nskill: skill_release_db_batch_packaging\nparameters:\n  module_path: \"{{module_path}}\"\n  objective: \"{{objective}}；请产出 Batch0~BatchN 交付规范与执行入口建议。\"\n  target_db: \"{{target_db}}\"\n  # execution_tool: \"{{execution_tool}}\"  # 可省略；runner 将按 target_db 从 company_profile.yaml 注入\n  # require_precheck_gate: true            # 可省略；runner 将从 company_profile.yaml 注入\n  context_id: \"{{context_id}}\"\n  trace_id: \"{{trace_id}}\"\n  input_artifact_refs: []\n```\n\n### Step 2 - 发布前闸门\n- Skill：`skill_governance_db_merged_integrity_gate`\n- 目的：校验 merged/batch 覆盖完整性，防缺段、缺关键表、缺必需文件。\n- Step2 input_artifact_refs：必须引用 Step1 的产物（至少 `A2`，可附 `A1/A3`）。\n- 预期产物：\n  - `A1`：A1_integrity_checklist.md\n  - `A2`：A2_integrity_ruleset.md\n  - `A3`：A3_command_template.md\n- 对 Codex 的调用模板：\n```yaml\nskill: skill_governance_db_merged_integrity_gate\nparameters:\n  module_path: \"{{module_path}}\"\n  objective: \"{{objective}}；基于 Batch manifest 建立发布前完整性闸门。\"\n  required_files:\n    - \"Batch_all_merged.sql\"\n    - \"Batch2_core_schema.sql\"\n  required_segments: []\n  required_tables: []\n  allow_partial: false\n  tool_mode: \"script-assisted\"\n  # require_precheck_gate: true            # 可省略；runner 将从 company_profile.yaml 注入\n  context_id: \"{{context_id}}\"\n  trace_id: \"{{trace_id}}\"\n  input_artifact_refs:\n    - \"A2\"\n```\n\n### Step 3 - 执行窗口 Runbook\n- Skill：`skill_release_db_execution_runbook`\n- 目的：基于 Step1+Step2 结论，给出 Fresh/Incremental 双场景的最小可操作执行手册。\n- Step3 input_artifact_refs：必须引用 Step1 与 Step2 的关键结论（建议 `A2`, `A3`, `A2`）。\n- 预期产物：\n  - `A1`：A1_release_runbook.md\n  - `A2`：A2_failfast_and_rollback.md\n  - `A3`：A3_tool_specific_commands.md\n- 对 Codex 的调用模板：\n```yaml\nskill: skill_release_db_execution_runbook\nparameters:\n  module_path: \"{{module_path}}\"\n  objective: \"{{objective}}；结合批次包与闸门结果，生成最小执行窗口 Runbook。\"\n  target_db: \"{{target_db}}\"\n  # execution_tool: \"{{execution_tool}}\"  # 可省略；runner 将按 target_db 从 company_profile.yaml 注入\n  # schema_strategy: \"{{schema_strategy}}\" # 可省略；runner 将从 company_profile.yaml 注入\n  # require_precheck_gate: true            # 可省略；runner 将从 company_profile.yaml 注入\n  context_id: \"{{context_id}}\"\n  trace_id: \"{{trace_id}}\"\n  input_artifact_refs:\n    - \"A2\"\n    - \"A3\"\n    - \"A2\"\n```\n\n## Artifacts 交接规则\n- Step2 必须消费 Step1 的 manifest 结论（`input_artifact_refs` 至少含 Step1 的 `A2`）。\n- Step3 必须消费 Step1 + Step2 的结论（`input_artifact_refs` 包含两步关键产物）。\n- 每步产物按 `A1/A2/A3` 编号输出，便于 pipeline runner 串接。\n\n## Pipeline 输出\n- 批次交付方案（目录/manifest/run_all 入口）。\n- 完整性闸门规则（文件、段顺序、关键对象）。\n- 执行窗口手册（Fresh/Incremental、停损点、回滚点、工具最短命令）。\n"
    },
    {
      "pipeline": "prompt-dsl-system/04_ai_pipeline_orchestration/pipeline_ownercommittee_audit_fix.md",
      "skills_referenced": [
        "skill_code_dependency_trace",
        "skill_code_fix_type_mismatch",
        "skill_code_security_hardening",
        "skill_code_generate_change_ledger",
        "skill_docs_generate_module_readme"
      ],
      "content_backup": "# Pipeline: OwnerCommittee 模块链路审计与修复\n\n## 适用场景\n- 面向 ownercommittee 域问题定位与修复。\n- 目标链路：UI -> Controller -> Service -> Mapper。\n\n## 模块边界（强约束）\n- 仅允许在 ownercommittee 域内扫描与修复。\n- 禁止跨域改动无关模块；若根因疑似跨域，先记录证据并停止自动扩散修改。\n\n## 输入\n- `module_path`：ownercommittee 模块路径。\n- `objective`：问题描述、复现路径、影响范围、已知约束（如兼容历史数据）。\n- `context_id`：可选；跨 step 上下文标识（未提供可由执行方生成）。\n- `trace_id`：推荐；每次 pipeline run 唯一追踪标识。\n- `input_artifact_refs`：可选；旧模式不提供也可执行，新模式建议按 A 编号交接。\n\n## 执行步骤（Skills 顺序固定）\n\n### Step 1 - 依赖链路追踪\n- Skill：`skill_code_dependency_trace`\n- 目的：定位 UI->Controller->Service->Mapper 链路和根因。\n- 交接：产出链路与根因定位 `A1`，供后续修复使用。\n- 对 Codex 的调用模板：\n```yaml\nskill: skill_code_dependency_trace\nparameters:\n  module_path: \"{{module_path}}\"\n  objective: \"{{objective}}；请输出 ownercommittee 链路图、调用入口和根因定位。\"\n  context_id: \"{{context_id}}\"\n  trace_id: \"{{trace_id}}\"\n  input_artifact_refs: []\n```\n\n### Step 2 - 类型不匹配修复\n- Skill：`skill_code_fix_type_mismatch`\n- 目的：修复 ID/Long/BigDecimal/String 等类型不一致问题。\n- 交接：优先引用 `A1`，产出修复补丁与类型校验结果 `A2`。\n- 对 Codex 的调用模板：\n```yaml\nskill: skill_code_fix_type_mismatch\nparameters:\n  module_path: \"{{module_path}}\"\n  objective: \"{{objective}}；重点修复 ID/Long/BigDecimal/String 类型转换与边界校验。\"\n  context_id: \"{{context_id}}\"\n  trace_id: \"{{trace_id}}\"\n  input_artifact_refs: [\"A1\"]\n```\n\n### Step 3 - 模块内安全加固\n- Skill：`skill_code_security_hardening`\n- 目的：仅在 ownercommittee 模块内做输入校验、权限边界和敏感处理加固。\n- 交接：优先引用 `A2`，产出安全加固清单与补丁 `A3`。\n- 对 Codex 的调用模板：\n```yaml\nskill: skill_code_security_hardening\nparameters:\n  module_path: \"{{module_path}}\"\n  objective: \"{{objective}}；仅在 ownercommittee 域内执行安全加固，不跨模块。\"\n  context_id: \"{{context_id}}\"\n  trace_id: \"{{trace_id}}\"\n  input_artifact_refs: [\"A2\"]\n```\n\n### Step 4 - 变更台账生成\n- Skill：`skill_code_generate_change_ledger`\n- 目的：形成可审计的修复台账（变更点、原因、影响面、回归建议）。\n- 交接：优先引用 `A2` 与 `A3`，产出变更台账 `A4`。\n- 对 Codex 的调用模板：\n```yaml\nskill: skill_code_generate_change_ledger\nparameters:\n  module_path: \"{{module_path}}\"\n  objective: \"{{objective}}；生成变更台账并标注风险与回归范围。\"\n  context_id: \"{{context_id}}\"\n  trace_id: \"{{trace_id}}\"\n  input_artifact_refs: [\"A2\", \"A3\"]\n```\n\n### Step 5 - 模块文档更新\n- Skill：`skill_docs_generate_module_readme`\n- 目的：更新模块 README，沉淀链路、修复点、运行与排障说明。\n- 交接：优先引用 `A4`，产出 README 更新稿 `A5`。\n- 对 Codex 的调用模板：\n```yaml\nskill: skill_docs_generate_module_readme\nparameters:\n  module_path: \"{{module_path}}\"\n  objective: \"{{objective}}；更新 ownercommittee 模块 README，覆盖修复与运维要点。\"\n  context_id: \"{{context_id}}\"\n  trace_id: \"{{trace_id}}\"\n  input_artifact_refs: [\"A4\"]\n```\n\n## 自监控条件（防转圈）\n- 若同一错误在连续 2 轮修复后仍复现，或出现重复失败模式：\n  1. 触发扩大扫描（仅扩大到直接依赖边界，仍禁止无界扩散）。\n  2. 产出“已尝试路径与失败证据”。\n  3. 立即停止自动修复，请求人工介入确认。\n"
    },
    {
      "pipeline": "prompt-dsl-system/04_ai_pipeline_orchestration/pipeline_sql_oracle_to_dm8.md",
      "skills_referenced": [
        "skill_sql_portability_audit",
        "skill_sql_convert_oracle_to_dm8",
        "skill_sql_index_review",
        "skill_sql_data_migration_plan"
      ],
      "content_backup": "# Pipeline: SQL Oracle -> DM8 迁移流水线\n\n## 适用场景\n- 目标：将 Oracle SQL 脚本迁移到 DM8。\n- 边界：仅做语法层兼容和可移植性修正，不改变核心表结构语义与业务逻辑。\n\n## 输入\n- `module_path`：模块路径（例如仓库内子模块路径）。\n- `objective`：必须包含以下信息：\n  - SQL 文件路径或内容来源\n  - 迁移约束（禁止改动项、兼容要求、性能限制）\n- `context_id`：可选；跨 step 上下文标识（未提供可由执行方生成）。\n- `trace_id`：推荐；每次 pipeline run 唯一追踪标识。\n- `input_artifact_refs`：可选；旧模式不提供也可执行，新模式建议按 A 编号交接。\n\n## 执行步骤（Skills 顺序固定）\n\n### Step 1 - 可移植性审计\n- Skill：`skill_sql_portability_audit`\n- 目的：先找出 Oracle 专有语法、函数、分页/序列/连接等兼容风险。\n- 交接：产出风险清单 `A1`，供后续转换 step 引用。\n- 对 Codex 的调用模板：\n```yaml\nskill: skill_sql_portability_audit\nparameters:\n  module_path: \"{{module_path}}\"\n  objective: \"{{objective}}；请输出 Oracle->DM8 可移植性风险分级与定位清单。\"\n  context_id: \"{{context_id}}\"\n  trace_id: \"{{trace_id}}\"\n  input_artifact_refs: []\n```\n\n### Step 2 - 语法转换\n- Skill：`skill_sql_convert_oracle_to_dm8`\n- 目的：按审计结果进行 DM8 兼容语法改写，保持结构语义稳定。\n- 交接：优先引用 Step1 的 `A1` 风险清单，产出转换 SQL `A2`。\n- 对 Codex 的调用模板：\n```yaml\nskill: skill_sql_convert_oracle_to_dm8\nparameters:\n  module_path: \"{{module_path}}\"\n  objective: \"{{objective}}；基于 Step1 风险清单完成 Oracle SQL 到 DM8 的语法转换。\"\n  context_id: \"{{context_id}}\"\n  trace_id: \"{{trace_id}}\"\n  input_artifact_refs: [\"A1\"]\n```\n\n### Step 3 - 索引策略复核\n- Skill：`skill_sql_index_review`\n- 目的：确认转换后 SQL 的索引可用性、冗余风险与潜在性能退化点。\n- 交接：优先引用 Step2 的 `A2` 转换 SQL，产出索引评审结果 `A3`。\n- 对 Codex 的调用模板：\n```yaml\nskill: skill_sql_index_review\nparameters:\n  module_path: \"{{module_path}}\"\n  objective: \"{{objective}}；基于转换后 SQL 复核索引覆盖、冗余和性能风险。\"\n  context_id: \"{{context_id}}\"\n  trace_id: \"{{trace_id}}\"\n  input_artifact_refs: [\"A2\"]\n```\n\n### Step 4 - 迁移与回滚计划\n- Skill：`skill_sql_data_migration_plan`\n- 目的：给出执行批次、校验点、回滚窗口与故障回退动作。\n- 交接：优先引用 `A2`（转换 SQL）和 `A3`（索引复核）形成迁移计划 `A4`。\n- 对 Codex 的调用模板：\n```yaml\nskill: skill_sql_data_migration_plan\nparameters:\n  module_path: \"{{module_path}}\"\n  objective: \"{{objective}}；给出上线迁移批次、数据校验与回滚方案。\"\n  context_id: \"{{context_id}}\"\n  trace_id: \"{{trace_id}}\"\n  input_artifact_refs: [\"A2\", \"A3\"]\n```\n\n## Pipeline 输出\n- 迁移 SQL（按文件/对象分组，建议编号如 `A2_*`）。\n- 风险清单（语法风险、性能风险、执行风险，建议编号如 `A1_*`/`A3_*`）。\n- 回滚建议（触发条件、回滚步骤、验证点，建议编号如 `A4_*`）。\n- 下一步执行命令（如适用：预演、备份、执行、校验命令）。\n"
    }
  ]
}