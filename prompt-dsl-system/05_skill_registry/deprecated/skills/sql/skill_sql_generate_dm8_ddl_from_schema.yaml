# DEPRECATED: replaced by skill_hongzhi_universal_ops
# Suggested mode: sql
# Mapping hints: Use mode=sql; put refs_hint=skill_sql_generate_dm8_ddl_from_schema in objective/constraints; preserve legacy acceptance checks.
# Original name: skill_sql_generate_dm8_ddl_from_schema
name: "skill_sql_generate_dm8_ddl_from_schema"
description: "Generate DM8 DDL from logical or Oracle-style schema definitions."
version: "1.0.0"
domain: "sql"
tags:
  - "sql"
  - "ddl"
  - "dm8"
  - "schema"
  - "generation"
parameters:
  - name: "host"
    type: "string"
    required: false
    description: "Optional placeholder; do not include real secrets. Database or service host."
  - name: "schema"
    type: "string"
    required: false
    description: "Optional placeholder; do not include real secrets. Target schema or namespace."
  - name: "user"
    type: "string"
    required: false
    description: "Optional placeholder; do not include real secrets. Execution or owner account."
  - name: "token"
    type: "string"
    required: false
    description: "Optional placeholder; do not include real secrets. Access token or credential placeholder."
  - name: "module_path"
    type: "string"
    required: true
    description: "Repository module scope for execution."
  - name: "objective"
    type: "string"
    required: true
    description: "Concrete task objective."
  - name: "context_id"
    type: "string"
    required: false
    description: "Pipeline-run context identifier for cross-step linkage."
  - name: "trace_id"
    type: "string"
    required: false
    description: "Unique trace id for the run (recommended)."
  - name: "input_artifact_refs"
    type: "array"
    required: false
    items: string
    description: "Artifact ids from previous steps (e.g., [\"A1\", \"A2\"])."
prompt_template: |
  You are the enterprise delivery assistant.
  Skill: skill_sql_generate_dm8_ddl_from_schema
  Goal: Generate DM8 DDL from logical or Oracle-style schema definitions.

  Input:
  - host: {{host}}
  - schema: {{schema}}
  - user: {{user}}
  - token: {{token}}
  - module_path: {{module_path}}
  - objective: {{objective}}
  - context_id: {{context_id}}
  - trace_id: {{trace_id}}
  - input_artifact_refs: {{input_artifact_refs}}

  Execution focus:
  - Produce normalized DM8 table, index, and constraint DDL with conversion notes.
  - Produce outputs that are directly actionable for engineering delivery.

  Objective template preference:
  - Prefer objective formatted with fields: inputs, constraints, acceptance, forbidden.

  Artifact handoff requirements:
  - Number artifacts as A1, A2, A3...
  - Include numbered prefixes in artifacts.name (for example: A1_primary_output).

  Upstream artifact reference rule:
  - If input_artifact_refs is provided, read and cite those artifact ids before generating new artifacts.

  Return ONLY the unified output structure:
  - summary
  - artifacts[]
  - risks[]
  - next_actions[]
output_contract:
  summary: "Concise outcome summary with scope and result."
  artifacts:
    - id: "A1"
      name: "A1_primary_artifact"
      description: "Concrete primary output such as SQL scripts, patch notes, diagrams, reports, or checklists."
    - id: "A2"
      name: "A2_supporting_artifact"
      description: "Supporting output such as risk details, evidence, mappings, or validation notes."
  risks:
    - "Known risks, assumptions, and compatibility concerns."
  next_actions:
    - "Ordered operational follow-ups for implementation."
examples:
  - input:
      host: "<HOST>"
      schema: "<SCHEMA>"
      user: "<USER>"
      token: "<TOKEN>"
      module_path: "<MODULE_PATH>"
      objective: |
        inputs: "<MODULE_PATH>/input_source_or_excerpt"
        constraints: "Keep compatibility constraints; avoid out-of-scope structural changes."
        acceptance: "Return numbered artifacts A1/A2 and actionable next actions."
        forbidden: "Do not modify forbidden paths or reveal sensitive information."
      context_id: "CTX-<MODULE_PATH>"
      trace_id: "TRACE-<TOKEN>"
      input_artifact_refs:
        - "A1"
    output:
      summary: "Task completed for scoped objective with traceable deliverables."
      artifacts:
        - id: "A1"
          name: "A1_primary_artifact_package_for_skill_sql_generate_dm8_ddl_from_schema"
          description: "Primary artifact package generated by the skill."
        - id: "A2"
          name: "A2_risk_and_validation_notes"
          description: "Risk findings and validation notes."
      risks:
        - "Environment-specific validation may still be required."
      next_actions:
        - "Run dry-run validation in a controlled environment."
